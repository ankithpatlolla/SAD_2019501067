<!DOCTYPE html>
<html>
	<head>
		<title>Home</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	</head>
	<style type="text/css">
		body {
  margin: 20px;
  font-family: Arial, Helvetica, sans-serif;
}

h5 {
	color: lightblue;
}
.topnav {
  overflow: hidden;
  background-color: gray;
}
.topnav button:hover {
  background-color: #ddd;
  color: black;
}


.topnav-right {
  float: right;
}
table {
    border: 2px solid black;
    border-collapse: collapse;
    text-align: center;
    width: 50%;
}

th, td {
    border: 1px solid black;
    padding: 5px;
    text-align: center;
}

th {
    background-color: lightgrey;

}

</style>

	<script type="text/javascript">

		             function bookpage(isbn) {
							console.log(isbn.getAttribute('name'));
							}

		document.addEventListener('DOMContentLoaded', () => {
                  document.querySelector('#form').onsubmit = () => {
                  	const request = new XMLHttpRequest();

                  	const search_msg = document.querySelector('#search_msg').value;

                  	request.open('POST', '/api/search');

			        
      

                  	request.onload = () => {
                  		const data = JSON.parse(request.responseText);
                  		s = "";
                  		s += '<table>'+'<tr>'+'<th>'+ "ISBN" + '</th>' +'<th>'+ "Title" +'</th>' +'<th>'
                  			+ "Author"+'</th>' +'</tr>'
                  		for(let i = 0; i < data.books.length; i++) {

                  			// var isb = data.books[i].isbn;
                  			s += '<tr>'+'<td>'+'<button name='+data.books[i].isbn+' id="btn" onclick= bookpage(this)>'  + data.books[i].isbn +'</button>'+ '</td>'+'<td>' + data.books[i].title + '</td>'+'<td>' + data.books[i].author + '</td>' +'</tr>' 
                  			// s += data.books[i].isbn + " "+ data.books[i].title + " " + data.books[i].author;
                  			// console.log(data.books[i].title);

                  			// var isb = data.books[i].isbn;

                  		}
                  		s += '</table>'



                  		document.querySelector('#output').innerHTML = s;

                  	}

						
                  	// document.getElementById('btn').onclick = bookpage(isb);	


                  	const data = new FormData();
			        data.append('key', search_msg);

			        request.send(data);
			        return false;
                  };
              });


	</script>

	<body>

		<div class="topnav">
			<div class="topnav-left">
				<h5>{{username}}</h5>
			</div>
			  <div class="topnav-right">
					<div class="button">
						<a href="/logout" class="btn btn-primary">Logout</a>
					</div>
		
			  </div>
	    </div>
<br><br>
	    <form id="form">
			<div class="form-group">
				<label style="font-size: 30px">Search books</label>
				<input id="search_msg" name = "name" type="text" class="form-control" placeholder="please enter here" required>
			</div>

			<div class="button">
				<button type="submit" align="center" class="btn btn-primary">Search</button>
			</div>
		</form>

		<div id="output">

		</div>


	</body>
</html>